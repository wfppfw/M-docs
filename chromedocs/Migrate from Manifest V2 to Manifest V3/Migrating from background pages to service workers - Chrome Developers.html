<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Migrating from background pages to service workers | Moon-docs</title>
    <meta name="description" content="moon的学习文档组件库">
    <link rel="stylesheet" href="/M-docs/assets/style.df9b2321.css">
    <link rel="modulepreload" href="/M-docs/assets/app.8d96fb22.js">
    <link rel="modulepreload" href="/M-docs/assets/chromedocs_Migrate from Manifest V2 to Manifest V3_Migrating from background pages to service workers - Chrome Developers.md.ca5a977e.lean.js">
    
    <link rel="icon" href="/moonLogo.png">
  <script></script>
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-f44a984a><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-f44a984a data-v-a50780ff><div class="VPNavBar has-sidebar" data-v-a50780ff data-v-6f1d18b5><div class="container" data-v-6f1d18b5><div class="VPNavBarTitle has-sidebar" data-v-6f1d18b5 data-v-d5925166><a class="title" href="/M-docs/" data-v-d5925166><!--[--><!--]--><!--[--><img class="VPImage logo" src="/M-docs/./moonLogo.png" alt data-v-b7ac6bd3><!--]--><!--[-->Moon&#39;s docs<!--]--><!--[--><!--]--></a></div><div class="content" data-v-6f1d18b5><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6f1d18b5 data-v-f83db6ba><span id="main-nav-aria-label" class="visually-hidden" data-v-f83db6ba>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/M-docs/guide/installation.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Guide<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/M-docs/components/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Component<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/M-docs/chromedocs/index.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Extension Docs<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/M-docs/demo/index.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Demo<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/M-docs/snippet/index.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Snippet<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/M-docs/tools/community.html" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->Tool<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6f1d18b5 data-v-a3e7452b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-a3e7452b data-v-481098f9 data-v-eba7420e><span class="check" data-v-eba7420e><span class="icon" data-v-eba7420e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-481098f9><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-481098f9><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6f1d18b5 data-v-738bef5a data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://gitee.com/geeksdidi" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6f1d18b5 data-v-e4361c82 data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ffb57d3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ffb57d3><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><!----><!--[--><!--[--><!----><div class="group" data-v-e4361c82><div class="item appearance" data-v-e4361c82><p class="label" data-v-e4361c82>Appearance</p><div class="appearance-action" data-v-e4361c82><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-e4361c82 data-v-481098f9 data-v-eba7420e><span class="check" data-v-eba7420e><span class="icon" data-v-eba7420e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-481098f9><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-481098f9><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-e4361c82><div class="item social-links" data-v-e4361c82><div class="VPSocialLinks social-links-list" data-v-e4361c82 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://gitee.com/geeksdidi" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6f1d18b5 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-f44a984a data-v-b6162a8b><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-b6162a8b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-b6162a8b><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-b6162a8b>Menu</span></button><a class="top-link" href="#" data-v-b6162a8b> Return to top </a></div><aside class="VPSidebar" data-v-f44a984a data-v-a186aa16><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-a186aa16><span class="visually-hidden" id="sidebar-aria-label" data-v-a186aa16> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>welcome</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/index.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Index</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Welcome%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>welcome</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Whats%20new%20in%20Chrome%20extensions%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>What's new in Chrome extensions</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>Getting Started Guides</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Getting%20Started%20Guides/Welcome%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Welcome</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Getting%20Started%20Guides/Extensions%20101%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Extensions 101</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Getting%20Started%20Guides/Development%20basics%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Development basics</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Getting%20Started%20Guides/Reading%20time%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Reading time</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Getting%20Started%20Guides/Focus%20Mode%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Focus Mode</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Getting%20Started%20Guides/Tabs%20Manager%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Tabs Manager</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>Manifest V3</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Manifest%20V3/Welcome%20to%20Manifest%20V3%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Welcome to Manifest V3</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Manifest%20V3/Extensions%20platform%20vision%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Extensions platform vision</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Manifest%20V3/Overview%20of%20Manifest%20V3%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Overview of Manifest V3</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>Overview</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Overview/What%20are%20extensions_%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>What are extensions?</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Overview/What%20are%20themes_%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>What are themes?</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Overview/Frequently%20asked%20questions%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Frequently asked questions</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Overview/Extensions%20quality%20guidelines%20FAQ%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Extensions quality guidelines FAQ</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>Migrate from Manifest V2 to Manifest V3</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Migrate%20from%20Manifest%20V2%20to%20Manifest%20V3/Migrating%20to%20Manifest%20V3%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Migrating to Manifest V3</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Migrate%20from%20Manifest%20V2%20to%20Manifest%20V3/Manifest%20V3%20migration%20checklist%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Manifest V3 migration checklist</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/M-docs/chromedocs/Migrate%20from%20Manifest%20V2%20to%20Manifest%20V3/Migrating%20from%20background%20pages%20to%20service%20workers%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Migrating from background pages to service workers</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Migrate%20from%20Manifest%20V2%20to%20Manifest%20V3/Manifest%20V2%20support%20timeline%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Manifest V2 support timeline</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Migrate%20from%20Manifest%20V2%20to%20Manifest%20V3/Known%20issues%20when%20migrating%20to%20Manifest%20V3%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Known issues when migrating to Manifest V3</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup" data-v-a186aa16 data-v-6e45c352><div class="title" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>API reference</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/API%20reference%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>API reference</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup" data-v-a186aa16 data-v-6e45c352><div class="title" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>Samples</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="https://github.com/GoogleChrome/chrome-extensions-samples" target="_blank" rel="noreferrer" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Samples</span><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-3c355974><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>Develop extensions and themes</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Develop%20extensions%20and%20themes/Extension%20development%20overview%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Extension development overview</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Develop%20extensions%20and%20themes/Manifest%20file%20format%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Manifest file format.md</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Develop%20extensions%20and%20themes/Architecture%20overview%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Architecture overview</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Develop%20extensions%20and%20themes/Declare%20permissions%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Declare permissions</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Develop%20extensions%20and%20themes/Design%20the%20user%20interface%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Design the user interface</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Develop%20extensions%20and%20themes/Chrome%20Extensions%20Tutorial_%20Debugging%20extensions%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Debugging extensions</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>In depth_ core concepts</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20core%20concepts/Message%20passing%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Message passing</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20core%20concepts/Content%20scripts%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Content scripts</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20core%20concepts/Manage%20events%20with%20service%20workers%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Manage events with service workers</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20core%20concepts/Match%20patterns%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Match patterns</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20core%20concepts/Using%20promises%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Using promises</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20core%20concepts/Cross-origin%20isolation%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Cross-origin isolation</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>In depth_ security</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20security/Cross-origin%20XMLHttpRequest%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Cross-origin XMLHttpRequest</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20security/Using%20eval%20in%20Chrome%20extensions%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Using eval in Chrome extensions</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>In depth_ more topics</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20more%20topics/Overriding%20Chrome%20settings%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Overriding Chrome settings</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20more%20topics/Extending%20DevTools%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Extending DevTools</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20more%20topics/Chrome%20Extensions%20Tutorial_%20OAuth2%20-%20Authenticate%20users%20with%20Google%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>OAuth2 - Authenticate users with Google</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20more%20topics/Overriding%20Chrome%20pages%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Overriding Chrome pages</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/In%20depth_%20more%20topics/Rich%20notifications%20API%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Rich notifications API</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>Best practices</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Best%20practices/Protect%20user%20privacy%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Protect user privacy</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Best%20practices/Declare%20permissions%20and%20warn%20users%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Declare permissions and warn users</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Best%20practices/Stay%20secure%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Stay secure</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Best%20practices/Accessibility%20(a11y)%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Accessibility (a11y)</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Best%20practices/Localization%20message%20formats%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Localization message formats</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/Best%20practices/Give%20users%20options%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Give users options</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>distributing you extensions</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/distributing%20you%20extensions/Extension%20hosting%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Extension hosting</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/distributing%20you%20extensions/Alternative%20Chrome%20extension%20installation%20methods%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Alternative Chrome extension installation methods</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/distributing%20you%20extensions/Installing%20extensions%20on%20Linux%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Installing extensions on Linux</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/distributing%20you%20extensions/Tutorial_%20Google%20analytics%20-%20Chrome%20Developers.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Tutorial_ Google analytics</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-a186aa16><section class="VPSidebarGroup collapsible" data-v-a186aa16 data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>个人学习笔记</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/M-docs/chromedocs/notebook/index.html" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>基本入门</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-f44a984a data-v-d981fe29><div class="VPDoc has-sidebar has-aside" data-v-d981fe29 data-v-cfb513e0><div class="container" data-v-cfb513e0><div class="aside" data-v-cfb513e0><div class="aside-curtain" data-v-cfb513e0></div><div class="aside-container" data-v-cfb513e0><div class="aside-content" data-v-cfb513e0><div class="VPDocAside" data-v-cfb513e0 data-v-afc4c1a1><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-afc4c1a1 data-v-2865c0b0><div class="content" data-v-2865c0b0><div class="outline-marker" data-v-2865c0b0></div><div class="outline-title" data-v-2865c0b0>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-2865c0b0><span class="visually-hidden" id="doc-outline-aria-label" data-v-2865c0b0> Table of Contents for current page </span><ul class="root" data-v-2865c0b0 data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-afc4c1a1></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-cfb513e0><div class="content-container" data-v-cfb513e0><!--[--><!--]--><main class="main" data-v-cfb513e0><div style="position:relative;" class="vp-doc _M-docs_chromedocs_Migrate%20from%20Manifest%20V2%20to%20Manifest%20V3_Migrating%20from%20background%20pages%20to%20service%20workers%20-%20Chrome%20Developers" data-v-cfb513e0><div><ul><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#manifest" target="_blank" rel="noreferrer">Update your manifest</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#events" target="_blank" rel="noreferrer">Thinking with events</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#event_listeners" target="_blank" rel="noreferrer">Top-level event listeners</a><ul><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#state" target="_blank" rel="noreferrer">Persisting state with storage APIs</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#alarms" target="_blank" rel="noreferrer">Moving from timers to alarms</a></li></ul></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#workers" target="_blank" rel="noreferrer">Working with workers</a><ul><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#documents" target="_blank" rel="noreferrer">Parsing and traversing with XML/HTML</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#audio_vidio" target="_blank" rel="noreferrer">Audio/video playback and capture</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#canvas" target="_blank" rel="noreferrer">Rendering to a canvas</a></li></ul></li></ul><h1 id="migrating-from-background-pages-to-service-workers" tabindex="-1">Migrating from background pages to service workers <a class="header-anchor" href="#migrating-from-background-pages-to-service-workers" aria-hidden="true">#</a></h1><p>Published on Wednesday, July 29, 2020 • Updated on Tuesday, October 6, 2020</p><ul><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#manifest" target="_blank" rel="noreferrer">Update your manifest</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#events" target="_blank" rel="noreferrer">Thinking with events</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#event_listeners" target="_blank" rel="noreferrer">Top-level event listeners</a><ul><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#state" target="_blank" rel="noreferrer">Persisting state with storage APIs</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#alarms" target="_blank" rel="noreferrer">Moving from timers to alarms</a></li></ul></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#workers" target="_blank" rel="noreferrer">Working with workers</a><ul><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#documents" target="_blank" rel="noreferrer">Parsing and traversing with XML/HTML</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#audio_vidio" target="_blank" rel="noreferrer">Audio/video playback and capture</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#canvas" target="_blank" rel="noreferrer">Rendering to a canvas</a></li></ul></li></ul><p><em>Background pages</em> have been a fundamental component of the Chrome Extension platform since its introduction. To put it simply, background pages provide extension authors with an environment that lives independent of any other window or tab. This allows extensions to observe and take action in response to events.</p><p>In Manifest V3, the Chrome extension platform moves from background pages to <em>service workers</em>. As stated in <a href="https://developers.google.com/web/fundamentals/primers/service-workers/" target="_blank" rel="noreferrer">Service Workers: an Introduction</a>, a &quot;service worker is a script that your browser runs in the background, separate from a web page, opening the door to features that don&#39;t need a web page or user interaction.&quot; This is the technology that enables native-like experiences such as push notifications, rich offline support, background sync, and &quot;Add to Home Screen&quot; on the open web. Service workers were inspired in part by background pages in Chrome Extensions, but they iterate and improve on this model by tuning it for web-scale.</p><p>When migrating to this new background context, you&#39;ll need to keep two main things in mind. First, service workers are terminated when not in use and restarted when needed (similar to event pages). Second, service workers don&#39;t have access to DOM. We&#39;ll explore how to adapt to these challenges in the <a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#events" target="_blank" rel="noreferrer">Thinking with Events</a> and <a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#workers" target="_blank" rel="noreferrer">Working with Workers</a> sections below, respectively.</p><h2 id="update-your-manifest" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#manifest" target="_blank" rel="noreferrer">#</a> Update your manifest <a class="header-anchor" href="#update-your-manifest" aria-hidden="true">#</a></h2><p>Extensions register their background service workers in the <a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#events" target="_blank" rel="noreferrer">manifest</a> under the <code>&quot;background&quot;</code> field. This field uses the <code>&quot;service_worker&quot;</code> key, which specifies a single JavaScript file. In Manifest V2, this field was called <code>&quot;scripts&quot;</code> and allowed multiple scripts.</p><pre><code>{  &quot;name&quot;: &quot;Awesome Test Extension&quot;,  ...  &quot;background&quot;: {    &quot;service_worker&quot;: &quot;background.js&quot;  },  ...}
</code></pre><p>Find out more on the <a href="https://developer.chrome.com/docs/extensions/mv3/background_pages/#manifest" target="_blank" rel="noreferrer">Manage events with service workers</a> reference page.</p><h2 id="thinking-with-events" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#events" target="_blank" rel="noreferrer">#</a> Thinking with events <a class="header-anchor" href="#thinking-with-events" aria-hidden="true">#</a></h2><p>Like event pages, service workers are a special execution environment that are started to handle events they&#39;re interested in and are terminated when they&#39;re no longer needed. The following sections provide recommendations for writing code in an ephemeral, evented execution context.</p><p>Several of these concepts are covered in the Manifest V2 page, <a href="https://developer.chrome.com/docs/extensions/mv2/background_migration/" target="_blank" rel="noreferrer">Migrate to Event Driven Background Scripts</a>.</p><h2 id="top-level-event-listeners" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#event_listeners" target="_blank" rel="noreferrer">#</a> Top-level event listeners <a class="header-anchor" href="#top-level-event-listeners" aria-hidden="true">#</a></h2><p>In order for Chrome to successfully dispatch events to the appropriate listeners, extensions must register listeners in the first turn of the event loop. The most straightforward way to achieve this is to move event registration to the top-level of your service worker script.</p><p>The below snippet shows how an existing extension initializes its browser action listener in a persistent background page.</p><pre><code>// background.jschrome.storage.local.get([&quot;badgeText&quot;], ({ badgeText }) =&gt; {  chrome.action.setBadgeText({ text: badgeText });  // Listener is registered asynchronously  // This is NOT guaranteed to work in Manifest V3/service workers! Don&#39;t do this!  chrome.action.onClicked.addListener(handleActionClick);});
</code></pre><p>While this approach works in a persistent background page, it is <em>not</em> guaranteed to work in a service worker due to the asynchronous nature of the <a href="https://developer.chrome.com/docs/extensions/reference/storage/" target="_blank" rel="noreferrer">Storage APIs</a>. When a service worker is terminated, so are the event listeners associated with it. And since events are dispatched when a service worker starts, asynchronously registering events results in them being dropped because there&#39;s no listener registered when it is first spun up.</p><p>To address this, move the event listener registration to the top level of your script. This ensures that Chrome will be able to immediately find and invoke your action&#39;s click handler, even if your extension hasn&#39;t finished executing its async startup logic.</p><pre><code>// background.jschrome.storage.local.get([&quot;badgeText&quot;], ({ badgeText }) =&gt; {  chrome.action.setBadgeText({ text: badgeText });});// Listener is registered on startupchrome.action.onClicked.addListener(handleActionClick);
</code></pre><p>Manifest V3 consolidates <code>chrome.browserAction</code> and <code>chrome.pageAction</code> into a single <code>chrome.action</code> API.</p><h3 id="persisting-state-with-storage-apis" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#state" target="_blank" rel="noreferrer">#</a> Persisting state with storage APIs <a class="header-anchor" href="#persisting-state-with-storage-apis" aria-hidden="true">#</a></h3><p>One of the main things to get used to when adopting service workers is that they are short-lived execution environments. In more practical terms, an extension&#39;s service worker will start up, do some work, and get terminated repeatedly throughout a user&#39;s browser session. This poses a challenge to extension developers accustomed to long-lived background pages as application data is not immediately available in global variables.</p><p>The following Manifest V2 example recieves a name from a content script and persists it for later:</p><pre><code>// background.js// Don&#39;t do this! The service worker will be created and destroyed over the lifetime of your// extension, and this variable will be reset.let savedName = undefined;chrome.runtime.onMessage.addListener(({ type, name }) =&gt; {  if (type === &quot;set-name&quot;) {    savedName = name;  }});chrome.browserAction.onClicked.addListener((tab) =&gt; {  chrome.tabs.sendMessage(tab.id, { name: savedName });});
</code></pre><p>If we port this code directly to Manifest V3, requiring service workers, it&#39;s possible that the code will be terminated between when the name is set and the user clicks the browser action. If this happens, the set name will have been lost—and <code>savedName</code> will again be <code>undefined</code>.</p><p>We can fix this bug by treating the <a href="https://developer.chrome.com/docs/extensions/reference/storage/" target="_blank" rel="noreferrer">Storage APIs</a> as our source of truth:</p><pre><code>// background.jschrome.runtime.onMessage.addListener(({ type, name }) =&gt; {  if (type === &quot;set-name&quot;) {    chrome.storage.local.set({ name });  }});chrome.action.onClicked.addListener((tab) =&gt; {  chrome.storage.local.get([&quot;name&quot;], ({ name }) =&gt; {    chrome.tabs.sendMessage(tab.id, { name });  });});
</code></pre><h3 id="moving-from-timers-to-alarms" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#alarms" target="_blank" rel="noreferrer">#</a> Moving from timers to alarms <a class="header-anchor" href="#moving-from-timers-to-alarms" aria-hidden="true">#</a></h3><p>It&#39;s common for web developers to perform delayed or periodic operations using the <code>setTimeout</code> or <code>setInterval</code> methods. These APIs can fail in service workers, though, because the scheduler will cancel the timers when the service worker is terminated.</p><pre><code>// background.js// This worked in Manifest V2.const TIMEOUT = 3 * 60 * 1000; // 3 minutes in millisecondssetTimeout(() =&gt; {  chrome.action.setIcon({    path: getRandomIconPath(),  });}, TIMEOUT);
</code></pre><p>Instead, we can use the <a href="https://developer.chrome.com/docs/extensions/reference/alarms/" target="_blank" rel="noreferrer">Alarms API</a>. Like other listeners, alarm listeners should be registered in the top level of your script.</p><pre><code>// background.jschrome.alarms.create({ delayInMinutes: 3 });chrome.alarms.onAlarm.addListener(() =&gt; {  chrome.action.setIcon({    path: getRandomIconPath(),  });});
</code></pre><h2 id="working-with-workers" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#workers" target="_blank" rel="noreferrer">#</a> Working with workers <a class="header-anchor" href="#working-with-workers" aria-hidden="true">#</a></h2><p><a href="https://developers.google.com/web/ilt/pwa/introduction-to-service-worker" target="_blank" rel="noreferrer">Service workers</a> are a specialized kind of <a href="https://developer.mozilla.org/docs/Web/API/Worker" target="_blank" rel="noreferrer">web worker</a>, which are quite different from the web pages most web developers are used to working with. On a typical web page (or extension background page), the global execution context for JavaScript is of type <a href="https://developer.mozilla.org/docs/Web/API/Window" target="_blank" rel="noreferrer"><code>Window</code></a>. This object exposes the capabilities that web developers are used to working with: <code>window</code>, element, IndexedDB, <code>cookie</code>, <code>localStorage</code>, etc.</p><p>The <a href="https://developer.mozilla.org/docs/Web/API/ServiceWorkerGlobalScope" target="_blank" rel="noreferrer">global scope for service worker</a> is significantly more limited and doesn&#39;t have many of these features. Most notably, service workers don&#39;t have access to the DOM. Workers no longer provide <code>XMLHttpRequest</code>, but instead support the more modern <a href="https://developer.mozilla.org/docs/Web/API/Fetch_API" target="_blank" rel="noreferrer"><code>fetch()</code></a>. <code>URL.createObjectURL</code> is also not supported for service workers, due to its potential to create memory leaks.</p><p>The following sections cover some of the major use cases impacted by the move to service workers and recommendations on how to adapt.</p><h3 id="parsing-and-traversing-with-xml-html" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#documents" target="_blank" rel="noreferrer">#</a> Parsing and traversing with XML/HTML <a class="header-anchor" href="#parsing-and-traversing-with-xml-html" aria-hidden="true">#</a></h3><p>Since service workers don&#39;t have access to DOM, it&#39;s not possible for an extension&#39;s service worker to access the <a href="https://developer.mozilla.org/docs/Web/API/DOMParser" target="_blank" rel="noreferrer"><code>DOMParser</code></a> API or create an <code>&lt;iframe&gt;</code> to parse and traverse documents. Extension developers have two ways to work around this limitation: create a new tab or use a library. Which you choose will depend on your use case.</p><p>Libraries such as <a href="https://github.com/jsdom/jsdom" target="_blank" rel="noreferrer"><code>jsdom</code></a> can be used to emulate a typical browser window environment, complete with DOMParser, event propagation, and other capabilities like <code>requestAnimationFrame</code>. Lighter-weight alternatives like <a href="https://github.com/developit/undom" target="_blank" rel="noreferrer"><code>undom</code></a> provide just enough DOM to power many frontend frameworks and libraries.</p><p>Extensions that need a full native browser environment can use the <a href="https://developer.chrome.com/docs/extensions/reference/windows#method-create" target="_blank" rel="noreferrer"><code>chrome.windows.create()</code></a> and <a href="https://developer.chrome.com/docs/extensions/reference/tabs#method-create" target="_blank" rel="noreferrer"><code>chrome.tabs.create()</code></a> APIs from inside a service worker to create a real browser window. Additionally, an extension&#39;s popup still provides a full (temporary) window environment.</p><h3 id="audio-video-playback-and-capture" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#audio_vidio" target="_blank" rel="noreferrer">#</a> Audio/video playback and capture <a class="header-anchor" href="#audio-video-playback-and-capture" aria-hidden="true">#</a></h3><p>It&#39;s not currently possible to play or capture media directly in a service worker. In order for a Manifest V3 extension to leverage the web&#39;s media playback and capture capabilities, the extension will need to create a window environment using either <a href="https://developer.chrome.com/docs/extensions/reference/windows#method-create" target="_blank" rel="noreferrer"><code>chrome.windows.create()</code></a> or <a href="https://developer.chrome.com/docs/extensions/reference/tabs#method-create" target="_blank" rel="noreferrer"><code>chrome.tabs.create()</code></a>. Once created, the extension can use <a href="https://developer.chrome.com/docs/extensions/mv3/messaging/" target="_blank" rel="noreferrer">message passing</a> to coordinate between the playback document and service worker.</p><h3 id="rendering-to-a-canvas" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/migrating_to_service_workers/#canvas" target="_blank" rel="noreferrer">#</a> Rendering to a canvas <a class="header-anchor" href="#rendering-to-a-canvas" aria-hidden="true">#</a></h3><p>In some cases developers use background pages to render content for display in other contexts or to create and cache assets. While service workers don&#39;t have access to DOM and therefore cannot use <code>&lt;canvas&gt;</code> elements, service workers do have access to the <a href="https://html.spec.whatwg.org/multipage/canvas.html#the-offscreencanvas-interface" target="_blank" rel="noreferrer">OffscreenCanvas API</a>.</p><pre><code>// background.js// for Manifest V2 background pagesfunction buildCanvas(width, height) {  const canvas = document.createElement(&quot;canvas&quot;);  canvas.width = width;  canvas.height = height;  return canvas;}
</code></pre><p>In the above block we&#39;re constructing a canvas element. To migrate to offscreen canvas, replace <code>document.createElement(&#39;canvas&#39;)</code> with <code>new OffscreenCanvas(width, height)</code>.</p><pre><code>// background.js// for Manifest V3 service workersfunction buildCanvas(width, height) {  const canvas = new OffscreenCanvas(width, height);  return canvas;}
</code></pre><p>For additional guidance on working with <code>OffscreenCanvas</code>, see <a href="https://developers.google.com/web/updates/2018/08/offscreen-canvas" target="_blank" rel="noreferrer">OffscreenCanvas—Speed up Your Canvas Operations with a Web Worker</a>.</p><p>Updated on Tuesday, October 6, 2020 • <a href="https://github.com/GoogleChrome/developer.chrome.com/blob/main/site/en/docs/extensions/mv3/migrating_to_service_workers/index.md" target="_blank" rel="noreferrer">Improve article</a></p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-cfb513e0 data-v-21f75714><div class="edit-info" data-v-21f75714><!----><div class="last-updated" data-v-21f75714><p class="VPLastUpdated" data-v-21f75714 data-v-18fe8fc2>Updated Date: <time datetime="2023-03-27T14:08:59.000Z" data-v-18fe8fc2></time></p></div></div><div class="prev-next" data-v-21f75714><div class="pager" data-v-21f75714><a class="pager-link prev" href="/M-docs/chromedocs/Migrate%20from%20Manifest%20V2%20to%20Manifest%20V3/Manifest%20V3%20migration%20checklist%20-%20Chrome%20Developers.html" data-v-21f75714><span class="desc" data-v-21f75714>Pagina prior</span><span class="title" data-v-21f75714>Manifest V3 migration checklist</span></a></div><div class="has-prev pager" data-v-21f75714><a class="pager-link next" href="/M-docs/chromedocs/Migrate%20from%20Manifest%20V2%20to%20Manifest%20V3/Manifest%20V2%20support%20timeline%20-%20Chrome%20Developers.html" data-v-21f75714><span class="desc" data-v-21f75714>Proxima pagina</span><span class="title" data-v-21f75714>Manifest V2 support timeline</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"chromedocs_api reference - chrome developers.md\":\"2dee4e13\",\"chromedocs_best practices_accessibility (a11y) - chrome developers.md\":\"b82404ea\",\"chromedocs_best practices_declare permissions and warn users - chrome developers.md\":\"cad32cb8\",\"chromedocs_best practices_give users options - chrome developers.md\":\"db797e06\",\"chromedocs_best practices_localization message formats - chrome developers.md\":\"47edd00d\",\"chromedocs_best practices_protect user privacy - chrome developers.md\":\"2dfb1735\",\"chromedocs_best practices_stay secure - chrome developers.md\":\"83e48aca\",\"chromedocs_develop extensions and themes_architecture overview - chrome developers.md\":\"5facaea8\",\"chromedocs_develop extensions and themes_chrome extensions tutorial_ debugging extensions - chrome developers.md\":\"d525a823\",\"chromedocs_develop extensions and themes_declare permissions - chrome developers.md\":\"74ade5e2\",\"chromedocs_develop extensions and themes_design the user interface - chrome developers.md\":\"440d1f3b\",\"chromedocs_develop extensions and themes_extension development overview - chrome developers.md\":\"1b923503\",\"chromedocs_develop extensions and themes_manifest file format - chrome developers.md\":\"2959f19e\",\"chromedocs_getting started guides_development basics - chrome developers.md\":\"fc3756f4\",\"chromedocs_getting started guides_extensions 101 - chrome developers.md\":\"5f3df2ca\",\"chromedocs_getting started guides_focus mode - chrome developers.md\":\"2f41e36e\",\"chromedocs_getting started guides_reading time - chrome developers.md\":\"53ffb487\",\"chromedocs_getting started guides_tabs manager - chrome developers.md\":\"a496ed4f\",\"chromedocs_getting started guides_welcome - chrome developers.md\":\"564469a8\",\"chromedocs_in depth_ core concepts_content scripts - chrome developers.md\":\"42696832\",\"chromedocs_in depth_ core concepts_cross-origin isolation - chrome developers.md\":\"9ce41ca2\",\"chromedocs_in depth_ core concepts_manage events with service workers - chrome developers.md\":\"72552eb6\",\"chromedocs_in depth_ core concepts_match patterns - chrome developers.md\":\"c69bd0fe\",\"chromedocs_in depth_ core concepts_message passing - chrome developers.md\":\"177f9f0c\",\"chromedocs_in depth_ core concepts_using promises - chrome developers.md\":\"eee3e214\",\"chromedocs_in depth_ more topics_chrome extensions tutorial_ oauth2 - authenticate users with google - chrome developers.md\":\"64b176b4\",\"chromedocs_in depth_ more topics_extending devtools - chrome developers.md\":\"5e6192dd\",\"chromedocs_in depth_ more topics_overriding chrome pages - chrome developers.md\":\"6b9616f6\",\"chromedocs_in depth_ more topics_overriding chrome settings - chrome developers.md\":\"1863dde4\",\"chromedocs_in depth_ more topics_rich notifications api - chrome developers.md\":\"9615903a\",\"chromedocs_in depth_ security_cross-origin xmlhttprequest - chrome developers.md\":\"af3bac06\",\"chromedocs_in depth_ security_using eval in chrome extensions - chrome developers.md\":\"37b9c72d\",\"chromedocs_manifest v3_extensions platform vision - chrome developers.md\":\"4b303f45\",\"chromedocs_manifest v3_overview of manifest v3 - chrome developers.md\":\"d1bf67fb\",\"chromedocs_manifest v3_welcome to manifest v3 - chrome developers.md\":\"65731ba3\",\"chromedocs_migrate from manifest v2 to manifest v3_known issues when migrating to manifest v3 - chrome developers.md\":\"4942969b\",\"chromedocs_migrate from manifest v2 to manifest v3_manifest v2 support timeline - chrome developers.md\":\"54afff38\",\"chromedocs_migrate from manifest v2 to manifest v3_manifest v3 migration checklist - chrome developers.md\":\"60f2814e\",\"chromedocs_migrate from manifest v2 to manifest v3_migrating from background pages to service workers - chrome developers.md\":\"ca5a977e\",\"chromedocs_migrate from manifest v2 to manifest v3_migrating to manifest v3 - chrome developers.md\":\"ea7fb060\",\"chromedocs_overview_extensions quality guidelines faq - chrome developers.md\":\"beaa7590\",\"chromedocs_overview_frequently asked questions - chrome developers.md\":\"93c0e4ea\",\"chromedocs_overview_what are extensions_ - chrome developers.md\":\"b002f059\",\"chromedocs_overview_what are themes_ - chrome developers.md\":\"42c0fd92\",\"chromedocs_samples - chrome developers.md\":\"b5246b90\",\"chromedocs_welcome - chrome developers.md\":\"11d4e078\",\"chromedocs_whats new in chrome extensions - chrome developers.md\":\"90c0b248\",\"chromedocs_distributing you extensions_alternative chrome extension installation methods - chrome developers.md\":\"36f7a2d8\",\"chromedocs_distributing you extensions_extension hosting - chrome developers.md\":\"3891717b\",\"chromedocs_distributing you extensions_installing extensions on linux - chrome developers.md\":\"bc70810d\",\"chromedocs_distributing you extensions_tutorial_ google analytics - chrome developers.md\":\"453aa6ed\",\"chromedocs_index.md\":\"803c254e\",\"chromedocs_notebook_index.md\":\"059ea5b3\",\"chromedocs_welcome.md\":\"54ac543e\",\"components_components1.md\":\"0ef34510\",\"components_index.md\":\"cff7a781\",\"demo_index.md\":\"b3a73a00\",\"guide_index.md\":\"215e6bdf\",\"guide_installation.md\":\"1d0d9fd4\",\"guide_quickstart.md\":\"85414567\",\"index.md\":\"fa40652c\",\"snippet_index.md\":\"6d1a226f\",\"tools_community.md\":\"6af922b6\",\"tools_demo.md\":\"3efb7cb8\",\"tools_index.md\":\"28bb692d\",\"tools_resources.md\":\"5cc6b5e0\",\"tools_tools.md\":\"33defef8\",\"tools_toy.md\":\"332f08c6\",\"vitepressuse.md\":\"fe552b5e\"}")</script>
    <script type="module" async src="/M-docs/assets/app.8d96fb22.js"></script>
    
  </body>
</html>