import{_ as e,o as t,c as o,a}from"./app.04ed3e28.js";const m=JSON.parse('{"title":"Tutorial: Google analytics","description":"","frontmatter":{},"headers":[{"level":2,"title":"# Requirements","slug":"requirements","link":"#requirements","children":[]},{"level":2,"title":"# Installing the tracking code","slug":"installing-the-tracking-code","link":"#installing-the-tracking-code","children":[]},{"level":2,"title":"# Tracking page views","slug":"tracking-page-views","link":"#tracking-page-views","children":[]},{"level":2,"title":"# Monitoring analytics requests","slug":"monitoring-analytics-requests","link":"#monitoring-analytics-requests","children":[]},{"level":2,"title":"# Tracking events","slug":"tracking-events","link":"#tracking-events","children":[]},{"level":2,"title":"# Sample code","slug":"sample-code","link":"#sample-code","children":[]}],"relativePath":"chromedocs/distributing you extensions/Tutorial_ Google analytics - Chrome Developers.md","lastUpdated":1679926139000}'),r={name:"chromedocs/distributing you extensions/Tutorial_ Google analytics - Chrome Developers.md"},n=a(`<ul><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-requirements" target="_blank" rel="noreferrer">Requirements</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-installing" target="_blank" rel="noreferrer">Installing the tracking code</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-tracking-pageviews" target="_blank" rel="noreferrer">Tracking page views</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-debugging" target="_blank" rel="noreferrer">Monitoring analytics requests</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-tracking-events" target="_blank" rel="noreferrer">Tracking events</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-samplecode" target="_blank" rel="noreferrer">Sample code</a></li></ul><h1 id="tutorial-google-analytics" tabindex="-1">Tutorial: Google analytics <a class="header-anchor" href="#tutorial-google-analytics" aria-hidden="true">#</a></h1><p>Published on Tuesday, September 18, 2012 \u2022 Updated on Wednesday, October 6, 2021</p><ul><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-requirements" target="_blank" rel="noreferrer">Requirements</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-installing" target="_blank" rel="noreferrer">Installing the tracking code</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-tracking-pageviews" target="_blank" rel="noreferrer">Tracking page views</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-debugging" target="_blank" rel="noreferrer">Monitoring analytics requests</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-tracking-events" target="_blank" rel="noreferrer">Tracking events</a></li><li><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-samplecode" target="_blank" rel="noreferrer">Sample code</a></li></ul><p>Caution</p><p>This page was migrated directly from the Manifest V2 documentation set. It has not yet been validated for compliance with Manifest V3.</p><p>This tutorial demonstrates using Google Analytics to track the usage of your extension.</p><h2 id="requirements" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-requirements" target="_blank" rel="noreferrer">#</a> Requirements <a class="header-anchor" href="#requirements" aria-hidden="true">#</a></h2><p>This tutorial expects that you have some familiarity writing extensions for Google Chrome. If you need information on how to write an extension, please read the <a href="https://developer.chrome.com/docs/extensions/mv3/getstarted/" target="_blank" rel="noreferrer">Getting Started tutorial</a>.</p><p>You will also need a <a href="http://www.google.com/analytics" target="_blank" rel="noreferrer">Google Analytics account</a> set up to track your extension. Note that when setting up the account, you can use any value in the Website&#39;s URL field, as your extension will not have an URL of its own.</p><p>![The analytics setup with info for a chrome extension filled out](./Tutorial_ Google analytics - Chrome Developers_files/0X6Knat4ozKRyF15shTn.png)</p><h2 id="installing-the-tracking-code" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-installing" target="_blank" rel="noreferrer">#</a> Installing the tracking code <a class="header-anchor" href="#installing-the-tracking-code" aria-hidden="true">#</a></h2><p>The standard Google Analytics tracking code snippet fetches a file named <code>ga.js</code> from an SSL protected URL if the current page was loaded using the <code>https://</code> protocol.</p><p><strong>Chrome extensions may <em>only</em> use the SSL-protected version of <code>ga.js</code></strong>. Loading <code>ga.js</code> over insecure HTTP is disallowed by Chrome&#39;s default <a href="https://developer.chrome.com/docs/extensions/mv3/contentSecurityPolicy/" target="_blank" rel="noreferrer">Content Security Policy</a>. This, plus the fact that Chrome extensions are hosted under the <code>chrome-extension://</code> schema, requires a slight modification to the usual tracking snippet to pull <code>ga.js</code> directly from <code>https://ssl.google-analytics.com/ga.js</code> instead of the default location.</p><p>Below is a modified snippet for the <a href="http://code.google.com/apis/analytics/docs/tracking/asyncTracking.html" target="_blank" rel="noreferrer">asynchronous tracking API</a> (the modified line is bolded):</p><pre><code>(function() {  var ga = document.createElement(&#39;script&#39;); ga.type = &#39;text/javascript&#39;; ga.async = true;  ga.src = &#39;https://ssl.google-analytics.com/ga.js&#39;;  var s = document.getElementsByTagName(&#39;script&#39;)[0]; s.parentNode.insertBefore(ga, s);})();
</code></pre><p>You&#39;ll also need to ensure that your extension has access to load the resource by relaxing the default content security policy. The policy definition in your <a href="https://developer.chrome.com/docs/extensions/mv3/tabs/" target="_blank" rel="noreferrer"><code>manifest.json</code></a> might look like:</p><pre><code>{  ...,  &quot;content_security_policy&quot;: {    &quot;extension_pages&quot;: &quot;script-src &#39;self&#39; https://ssl.google-analytics.com; object-src &#39;self&#39;&quot;,  },  ...}
</code></pre><p>Here is a popup page (<code>popup.html</code>) which loads the asynchronous tracking code via an external JavaScript file (<code>popup.js</code>) and tracks a single page view:</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt;   ...  &lt;script src=&quot;popup.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt;   ... &lt;/body&gt;&lt;/html&gt;

var _gaq = _gaq || [];_gaq.push([&#39;_setAccount&#39;, &#39;UA-XXXXXXXX-X&#39;]);_gaq.push([&#39;_trackPageview&#39;]);(function() {  var ga = document.createElement(&#39;script&#39;); ga.type = &#39;text/javascript&#39;; ga.async = true;  ga.src = &#39;https://ssl.google-analytics.com/ga.js&#39;;  var s = document.getElementsByTagName(&#39;script&#39;)[0]; s.parentNode.insertBefore(ga, s);})();
</code></pre><p>Keep in mind that the string <code>UA-XXXXXXXX-X</code> should be replaced with your own Google Analytics account number.</p><h2 id="tracking-page-views" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-tracking-pageviews" target="_blank" rel="noreferrer">#</a> Tracking page views <a class="header-anchor" href="#tracking-page-views" aria-hidden="true">#</a></h2><p>The <code>_gaq.push([&#39;_trackPageview&#39;]);</code> code will track a single page view. This code may be used on any page in your extension. When placed on a background page, it will register a view once per browser session. When placed on a popup, it will register a view once every time the popup is opened.</p><p>By looking at the page view data for each page in your extension, you can get an idea of how many times your users interact with your extension per browser session:</p><p>![Analytics view of the top content for a site](./Tutorial_ Google analytics - Chrome Developers_files/3AR714uoz3NIMkuFLmIC.png)</p><h2 id="monitoring-analytics-requests" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-debugging" target="_blank" rel="noreferrer">#</a> Monitoring analytics requests <a class="header-anchor" href="#monitoring-analytics-requests" aria-hidden="true">#</a></h2><p>To ensure that tracking data from your extension is being sent to Google Analytics, you can inspect the pages of your extension in the Developer Tools window (see the <a href="https://developer.chrome.com/docs/extensions/mv3/tut_debugging/" target="_blank" rel="noreferrer">debugging tutorial</a> for more information). As the following figure shows, you should see requests for a file named <strong>__utm.gif</strong> if everything is set up correctly.</p><p>![Developer Tools window showing the _<em>utm.gif request](./Tutorial</em> Google analytics - Chrome Developers_files/lPW0DjyEMWYnhPc336QN.png)</p><h2 id="tracking-events" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-tracking-events" target="_blank" rel="noreferrer">#</a> Tracking events <a class="header-anchor" href="#tracking-events" aria-hidden="true">#</a></h2><p>By configuring event tracking, you can determine which parts of your extension your users interact with the most. For example, if you have three buttons users may click:</p><pre><code>&lt;button id=&#39;button1&#39;&gt;Button 1&lt;/button&gt;&lt;button id=&#39;button2&#39;&gt;Button 2&lt;/button&gt;&lt;button id=&#39;button3&#39;&gt;Button 3&lt;/button&gt;
</code></pre><p>Write a function that sends click events to Google Analytics:</p><pre><code>function trackButton(e) {  _gaq.push([&#39;_trackEvent&#39;, e.target.id, &#39;clicked&#39;]);};
</code></pre><p>And use it as an event handler for each button&#39;s click:</p><pre><code>var buttons = document.querySelectorAll(&#39;button&#39;);for (var i = 0; i &lt; buttons.length; i++) {  buttons[i].addEventListener(&#39;click&#39;, trackButtonClick);}
</code></pre><p>The Google Analytics event tracking overview page will give you metrics regarding how many times each individual button is clicked:</p><p>![Analytics view of the event tracking data for a site](./Tutorial_ Google analytics - Chrome Developers_files/qhlPcW6Wh0oQC8csWwrO.png)</p><p>By using this approach, you can see which parts of your extension are under-or-overutilized. This information can help guide decisions about UI redesigns or additional functionality to implement.</p><p>For more information about using event tracking, see the Google Analytics <a href="https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide" target="_blank" rel="noreferrer">developer documentation</a>.</p><h2 id="sample-code" tabindex="-1"><a href="https://developer.chrome.com/docs/extensions/mv3/tut_analytics/#toc-samplecode" target="_blank" rel="noreferrer">#</a> Sample code <a class="header-anchor" href="#sample-code" aria-hidden="true">#</a></h2><p>An example extension that uses these techniques is available in the <a href="https://github.com/GoogleChrome/chrome-extensions-samples/tree/master/mv2-archive/tutorials/analytics/" target="_blank" rel="noreferrer">samples repository</a>.</p><p>Updated on Wednesday, October 6, 2021 \u2022 <a href="https://github.com/GoogleChrome/developer.chrome.com/blob/main/site/en/docs/extensions/mv3/tut_analytics/index.md" target="_blank" rel="noreferrer">Improve article</a></p>`,42),i=[n];function s(l,c,d,h,g,p){return t(),o("div",null,i)}const f=e(r,[["render",s]]);export{m as __pageData,f as default};
